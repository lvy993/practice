<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title></title>
		<style type="text/css">
			* {
				padding: 0;
				margin: 0;
			}
			
			.gameFace {
				width: 320px;
				margin: 100px auto;
				position: relative;
			}
			
			.gameFace #score {
				position: absolute;
				top: 12px;
				left: 60px;
				color: white;
				font-size: 20px;
			}
			/*è®¾ç½®æ¸¸æˆè¿›åº¦æ¡*/
			
			#progress {
				width: 180px;
				height: 16px;
				position: absolute;
				left: 63px;
				top: 66px;
				border-radius: 8px;
			}
			
			.wolf {
				width: 80px;
				position: absolute;
			}
			/*è®¾ç½®æ¸¸æˆè¯´æ˜*/
			
			.gameFace .begin,
			.gameFace .over {
				position: absolute;
				left: 0px;
				top: 190px;
				width: 320px;
				text-align: center;
			}
			
			.gameFace .begin a,
			.gameFace .over a,
			.gameFace .over span {
				display: block;
				font-size: 30px;
				text-shadow: 4px 0 4px greenyellow;
				text-decoration: none;
				color: red;
				font-weight: bold;
				margin: 20px 0;
			}
			
			.gameFace .over {
				display: none;
			}
		</style>
	</head>

	<body>
		<div class="gameFace">
			<img src="img/game_bg.jpg" id="back" />
			<!-- æ˜¾ç¤ºæ¸¸æˆåˆ†æ•°-->
			<div id="score">0</div>
			<!--è¿›åº¦æ¡-->
			<img src="img/progress.png" alt="" id="progress" />
			<!--è®¾ç½®æ¸¸æˆå¼€å§‹æŒ‰é’®å’Œæ¸¸æˆè¯´æ˜-->
			<div class="begin">
				<a href="###" id="begin">å¼€å§‹</a>
				<a href="###">æ¸¸æˆè¯´æ˜</a>
			</div>
			<div class="over">
				<span>GAME OVER</span>
				<a href="###" id="again">å†æ¥ä¸€å±€</a>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="js/tween.js"></script>
	<script type="text/javascript">
		var points = [
			[110, 137],
			[30, 182],
			[30, 245],
			[40, 317],
			[130, 297],
			[217, 319],
			[210, 234],
			[114, 214],
			[198, 163]
		];
		var indexs = []; //å­˜å‚¨å½“å‰æ­£åœ¨è¿è¡Œçš„ç‹¼çš„ä¸‹æ ‡
		/*è·å–å¯¹åº”çš„æŒ‰é’®*/
		//è·å–æ˜¾ç¤ºè¿›åº¦å›¾
		var progress = document.getElementById("progress")
			//è·å–åˆ†æ•°
		var socre = document.getElementById("score")
			//è·å–æ¸¸æˆç•Œé¢
		var gameFace = document.getElementsByClassName("gameFace")[0]
		var begins = document.getElementsByClassName("begin")[0]
		var start = document.getElementById("begin")
			//è·å–ç»“æŸæ¸¸æˆçš„divæ ‡ç­¾
		var over = document.getElementsByClassName("over")[0]
			//è·å–å†æ¥ä¸€æ¬¡æ ‡ç­¾
		var again = document.getElementById("again")
		begins.onclick = function() {
				begins.style.display = "none"
					//å¼€å§‹æ¸¸æˆ
				startGame()
					//å¼€å§‹è®¡æ—¶
				changeGame()
			}
			//å†æ¥ä¸€æ¬¡å…³è”äº‹ä»¶
		again.onclick = function() {
				over.style.display = "none"
					//å¼€å§‹æ¸¸æˆ
				startGame()
					//å¼€å§‹è®¡æ—¶
				changeGame()
					//åˆ†æ•°æ¸…é›¶
				score.innerHTML = 0;
			}
			//å®šä¹‰ä¸€ä¸ªå‡½æ•°å®Œæˆæ¸¸æˆæ“ä½œ
		var timer1;

		function startGame() {
			timer1 = setInterval(function() {
				var img = createWolf();
				var name = Math.random() * 100 < 20 ? "x" : "h";
				//å®šä¹‰æ—¶é—´è®¡æ—¶å™¨å®ŒæˆğŸºçš„è¿è¡Œ
				var orReverse = false; // å®šä¹‰ç”¨æ¥è®°å½•å½“å‰çš„è¿åŠ¨æ˜¯å¦åå‘
				var beginIndex = 0
				var timer2 = setInterval(function() {
					img.src = "img/" + name + beginIndex + ".png"
					if(beginIndex >= 5) {
						orReverse = true;
					}
					if(orReverse == false) {
						beginIndex++;
					} else {
						beginIndex--;
					}
					if(beginIndex < 0) {
						clearInterval(timer2);
						var index = indexs.indexOf(img.index);
						indexs.splice(index, 1);
						gameFace.removeChild(img);
					}

				}, 100)

				//ä¸ºç‹¼å…³è”å¯¹åº”ç‚¹å‡»äº‹ä»¶
				var orClick = false;
				img.onclick = function() {
					if(orClick == false) {
						orClick = true;
						//å®Œæˆåˆ†æ•°ä¿®æ”¹
						if(name == "x") {
							score.innerHTML = score.innerHTML - 10;
						} else {
							score.innerHTML = score.innerHTML - (-10);
						}

						//å‡»æ‰“æ“ä½œ
						var startHit = 6;
						clearInterval(timer2)
						var timer3 = setInterval(function() {
							img.src = "img/" + name + startHit + ".png"
							startHit++;
							if(startHit > 9) {
								clearInterval(timer3);
								var index = indexs.indexOf(img.index);
								indexs.splice(index, 1);
								gameFace.removeChild(img);
							}
						}, 100)
					}
				}

			}, 800)
		}
		//å®šä¹‰å‡½æ•°ç”Ÿæˆç°å¤ªç‹¼æˆ–å°ç°ç°æ“ä½œ   åˆ›å»ºå›¾ç‰‡æ ‡ç­¾
		function createWolf() {
			var img = document.createElement("img");
			var random = 0

			while(true) {
				random = getRandom(0, 9)
				if(indexs.indexOf(random) == -1) {
					indexs.push(random);
					break;
				}
			}
			//è·å–pointså¯¹åº”å›¾ç‰‡çš„ä½ç½® 
			var point = points[random];
			img.className = "wolf"
			img.style.left = point[0] + "px";
			img.style.top = point[1] + "px";
			img.index = random;
			//æ·»åŠ å›¾ç‰‡
			gameFace.appendChild(img)
			return img;

		}
		//å®šä¹‰å‡½æ•°äº§ç”Ÿéšæœºæ•°
		function getRandom(min, max) {
			return Math.floor(Math.random() * (max - min) + min);
		}

		//å®šä¹‰å‡½æ•°å®Œæˆæ—¶é—´è®¡æ—¶
		function changeGame() {
			var b = 180;
			var c = -180;
			var t = 0;
			var d = 50;
			var timerTotle = setInterval(function() {
				t++;
				progress.style.width = Tween.Cubic.easeInOut(t, b, c, d) + "px"
				if(t >= d) {
					clearInterval(timerTotle);
					over.style.display = "block"
						//åœæ­¢ç‹¼çš„äº§ç”Ÿ
					clearInterval(timer1);
				}
			}, 100)
		}
	</script>

</html>